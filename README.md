# Mental Health and Lifestyle Habits (2019‚Äì2024): Exploratory Analysis

## Project Description

This project performs an exploratory data analysis (EDA) on the "Mental Health and Lifestyle Habits (2019‚Äì2024)" dataset from Kaggle. The analysis aims to summarize the distribution of key variables, explore preliminary associations between lifestyle factors (e.g., sleep, exercise) and mental health outcomes (e.g., stress, anxiety), and establish a reproducible workflow for subsequent regression and predictive modeling.

## Repository Structure

* **`data/`**: Contains the raw dataset used for analysis (`Mental_Health_Lifestyle_Dataset.csv`).
* **`doc/`**: Contains the source R Markdown file for the final report (`final_report.Rmd`).
* **`src/`**: Contains modular R scripts responsible for data processing and generating core outputs.
* **`output/`**: Location for the compiled final report (`final_report.html`).
* **`Makefile`**: Automates the report generation process.
* **`Dockerfile`**: Docker configuration for containerized reproducibility.

## Code for Required Outputs

* **Table:** Generated by `src/02_create_table.R`.  
  This script summarizes descriptive statistics of key lifestyle and mental health variables.
* **Figure:** Generated by `src/03_create_figure.R`.  
  This script produces visualizations (e.g., distributions, correlations) used in the final report.

---

## How to Generate the Final Report

### Option 1: Using Docker (Recommended - Fully Reproducible)

Docker ensures complete reproducibility across different systems without needing to install R or any dependencies locally.

#### Docker Hub Repository

The Docker image for this project is publicly available on Docker Hub:

**üê≥ [wwd1203/550final on Docker Hub](https://hub.docker.com/r/wwd1203/550final)**

You can pull the pre-built image directly:

```bash
docker pull wwd1203/550final:latest
```

#### Building the Docker Image

If you want to build the image yourself from the Dockerfile:

```bash
# Navigate to project directory
cd /d/550Final

# Build the Docker image
docker build -t wwd1203/550final:latest .
```

Or use the Makefile:

```bash
make docker_build
```

This command reads the `Dockerfile` and creates an image with all necessary dependencies, R packages, and project files.

#### Running the Docker Container to Generate the Report

**Automated Method (Using Makefile):**

For Windows (Git Bash):
```bash
make docker_run
```

For Mac/Linux:
```bash
make docker_run_unix
```

**Manual Method:**

For Windows Git Bash:
```bash
mkdir -p report
docker run --rm -v /$(pwd)/report:/project/output wwd1203/550final:latest
```

For Mac/Linux:
```bash
mkdir -p report
docker run --rm -v $(pwd)/report:/project/output wwd1203/550final:latest
```

**What this does:**
1. Creates a `report/` directory in your current location (if it doesn't exist)
2. Runs the Docker container
3. Mounts the `report/` directory to the container's output location
4. Generates the report inside the container
5. Copies the generated files to your local `report/` directory
6. Automatically removes the container after completion

**Expected Output:**

After running, you'll find the following files in the `report/` directory:
- `final_report.html` - The complete analysis report
- `figure_1_gender.png` - Gender distribution visualization
- `figure_2_age.png` - Age distribution visualization  
- `figure_3_diet.png` - Diet quality visualization

---

### Option 2: Local Compilation (Without Docker)

#### Prerequisites

* **R (version 4.0 or higher)**: Ensure R is installed on your system
* **Required R Packages**: The project uses `renv` for package management
* **Data**: The dataset `Mental_Health_Lifestyle_Dataset.csv` must be in the `data/` directory

#### Installation and Compilation

1. **Clone the repository:**
   ```bash
   git clone https://github.com/WWD1203/550Final.git
   cd 550Final
   ```

2. **Restore R package environment:**
   ```bash
   make install
   ```
   This will use `renv` to restore all required packages as specified in `renv.lock`.

3. **Generate the report:**
   ```bash
   make
   ```
   This will execute all preprocessing scripts and render the final HTML report.

4. **View the report:**
   The compiled report will be available at `output/final_report.html`

---

## Makefile Targets

* `make` or `make all` - Restore packages and generate the final report
* `make install` - Restore the R package environment using renv
* `make clean` - Remove generated files and clean up the environment
* `make docker_build` - Build the Docker image
* `make docker_run` - Run Docker container and generate report (Windows Git Bash)
* `make docker_run_unix` - Run Docker container and generate report (Mac/Linux)

---

## Reproducibility

This project emphasizes reproducibility through:

1. **Package Management**: Using `renv` to lock package versions
2. **Containerization**: Docker ensures consistent execution environments
3. **Automated Workflow**: Makefile coordinates all build steps
4. **Version Control**: All code and configurations tracked in Git

---

## Troubleshooting

### Docker Issues

**Issue: Permission denied when mounting volumes (Linux/Mac)**
- Solution: Run with `sudo` or add your user to the docker group
  ```bash
  sudo usermod -aG docker $USER
  ```

**Issue: Path mounting not working on Windows**
- Solution: Use Git Bash terminal (not PowerShell or CMD)
- Ensure Docker Desktop has "File Sharing" enabled for your drive

**Issue: Report not generated in report/ directory**
- Check Docker container logs for errors
- Verify the report/ directory has write permissions
- Ensure Docker has access to your file system in Docker Desktop settings

### Local Compilation Issues

**Issue: Missing R packages**
- Solution: Run `make install` to restore packages via renv

**Issue: renv::restore() fails**
- Solution: Delete `renv/library/` and run `make install` again
  ```bash
  rm -rf renv/library
  make install
  ```

**Issue: Report rendering fails**
- Check that all files in `src/` are present
- Verify the dataset exists in `data/Mental_Health_Lifestyle_Dataset.csv`
- Review error messages in the R console

---

## System Requirements

### For Docker Method
- Docker Desktop (Windows/Mac) or Docker Engine (Linux)
- 4GB RAM minimum
- 5GB free disk space

### For Local Method
- R 4.0 or higher
- Operating System: Windows, macOS, or Linux
- 2GB RAM minimum

---

## Contributing

This is a course project. For questions or issues, please contact the repository owner.

## License

This project is for educational purposes.

## Authors

Wenduan Wang

## Acknowledgments

- Dataset source: Kaggle - Mental Health and Lifestyle Habits (2019‚Äì2024)
- Course: Data Science Methods (550)